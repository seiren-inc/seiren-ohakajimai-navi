# Doc-19 Release Checklist v1.1

Project: seiren-ohakajimai-navi

## 1. 目的

本ドキュメントは、
本プロジェクトを本番リリース可能と判断するための
最終判定チェックリストを定義する。

Antigravity は本チェックリストを通過しない限り
リリース不可。

例外なし。

---

## 2. リリース前絶対条件（必須）

### 2.1 環境確認

- [ ] ローカルパスが固定パスである
- [ ] iCloudを使用していない
- [ ] Node v22 である
- [ ] lockファイルが一致している

---

### 2.2 データ整合

- [ ] 自治体件数 1,737
- [ ] slug 一意性確認済み
- [ ] slug 空値なし
- [ ] PDF_ONLY 全件成立
- [ ] url に PDF直リンクなし
- [ ] pdfUrl のみ PDF格納
- [ ] 不要 notes 残存なし

いずれか未達 → 即停止

---

### 2.3 CI 成功確認

- [ ] verify:ci 成功
- [ ] 型チェック成功
- [ ] テスト成功
- [ ] 不変条件チェック成功
- [ ] ビルド成功
- [ ] E2E 主要シナリオ成功

CI失敗状態でのリリースは絶対禁止。

---

### 2.4 SEO 整合

- [ ] sitemap 生成成功
- [ ] sitemap 内URLは全て存在
- [ ] 重複URLなし
- [ ] title 重複なし
- [ ] description 重複なし
- [ ] canonical 正常
- [ ] robots.txt 正常

---

### 2.5 パフォーマンス

- [ ] build時間が基準値内
- [ ] 大量DOM箇所フリーズなし
- [ ] 初回表示で白画面なし
- [ ] レンダリング例外なし

---

### 2.6 セキュリティ

- [ ] 管理操作は認証必須
- [ ] API は認証必須（Level 1）
- [ ] レート制限実装済み
- [ ] 監査ログ保存確認
- [ ] ログ削除不可確認

---

### 2.7 バックアップ確認

- [ ] リポジトリ clone 可能
- [ ] 過去commitへ checkout 可能
- [ ] 復旧手順を実行可能

---

### 2.8 AI機能確認（導入済みの場合）

**内部AI監査（公開RAGの前提条件）**

- [ ] 内部AI監査バッチが最低30日間安定稼働済み
- [ ] 30日間の重大違反ゼロを確認（PDF_ONLY見逃し・件数不整合見逃し・slug重複見逃し）
- [ ] 内部監査の稼働ログが保存されており追跡可能

> ⚠️ 上記3項目が全て満たされない限り、公開RAGは有効化禁止。

> 🚫 内部AI監査が安定稼働30日未満の場合、公開RAGは**無効化状態**でなければならない。フィーチャーフラグ等で機能が無効化されていることを実装レベルで確認すること。

**公開RAG確認（上記前提が満たされた場合のみ実施）**

- [ ] 公開RAGは根拠必須で動作
- [ ] 根拠なし回答ゼロ
- [ ] 危険表現ゼロ
- [ ] 個人情報露出ゼロ
- [ ] レート制限有効

---

## 3. リスク確認

- [ ] 重大リスク一覧を再確認
- [ ] 未解決リスクなし
- [ ] 破壊的変更なし

---

## 4. 禁止事項最終確認

- [ ] force push していない
- [ ] 大量add していない
- [ ] 上書きしていない
- [ ] 破壊的スキーマ変更していない
- [ ] 不変条件を無視していない

---

## 5. 本番直前手順

1. 最新 main 取得
2. verify:ci 実行
3. 不変条件単体実行
4. sitemap 手動確認
5. 主要ページ手動確認
6. ログ確認

全て成功 → リリース可

---

## 6. リリース後監視

リリース後24時間は以下監視

- [ ] エラー率
- [ ] build異常
- [ ] sitemap異常
- [ ] AIログ異常

---

## 7. リリース判定フラグ

以下が全て Yes の場合のみ

**READY_FOR_PRODUCTION = TRUE**

一つでも No がある場合

**READY_FOR_PRODUCTION = FALSE**

---

## 8. 変更履歴

| Version | 内容                                                                                              |
| ------- | ------------------------------------------------------------------------------------------------- |
| v1.0    | 初版                                                                                              |
| v1.1    | AI機能確認セクションを強化（内部監査30日安定稼働の前提条件を追加し、公開RAG有効化ゲートを明示化） |
| v1.2    | 30日未満の場合、公開RAGは無効化状態でなければならないことを明示                                   |
