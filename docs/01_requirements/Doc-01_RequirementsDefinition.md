# Doc-01 Requirements Definition

## 1. Project Overview

本プロジェクト「seiren-ohakajimai-navi」は、日本全国の改葬・お墓じまい手続きに関する情報を集約し、ユーザーが自治体別の改葬許可情報、手続き方法、必要書類、相談窓口へ容易にアクセスできるポータルサイトを構築することを目的とする。

本システムは単なる情報サイトではなく、以下を統合する：

- 自治体データベース（全国約1,737自治体）
- 改葬許可申請情報の可視化
- 資料請求・相談導線
- 品質監査基盤
- SEO最適化構造
- 管理画面による運用管理

本プロジェクトはエンタープライズ品質を前提とする。

---

## 2. Objectives

主要目的：

1. 全国自治体改葬情報の網羅
2. ユーザー導線の最適化（問い合わせ・資料請求）
3. SEOによる自然流入最大化
4. データ品質の担保（監査・検証バリア）
5. 将来的なAPI公開への拡張性確保

---

## 3. Scope

### 含まれる範囲

- 自治体改葬許可情報ページ
- 都道府県別一覧ページ
- 改葬相談フォーム
- 資料請求フォーム
- 管理画面（品質監査含む）
- SEO（sitemap / robots / metadata）
- API v1（自治体取得）
- 監査ログ永続化

### 含まれない範囲

- 決済機能
- 外部業者マッチング自動化
- 会員制ログイン機能（現時点）

---

## 4. Stakeholders

- 運営：株式会社清蓮
- 開発：内部AI支援開発体制
- 利用者：
    - お墓じまい検討者
    - 家族・親族
    - 行政手続き担当者
- 管理者：
    - データ更新担当
    - 品質監査担当

---

## 5. Functional Requirements

### FR-01: 自治体一覧表示

- 都道府県別に自治体を表示
- JISコード順
- ページネーション対応

### FR-02: 自治体詳細表示

- 改葬許可申請情報表示
- 公式リンク（URL / PDF）
- リンクステータス表示
- 監査履歴表示

### FR-03: 検索機能

- 都道府県検索
- 自治体名検索

### FR-04: 相談フォーム

- 2ステップ構成
- バリデーション
- DB保存

### FR-05: 管理画面

- 品質ダッシュボード
- Issues一覧
- 自治体詳細ドリルダウン
- 監査実行履歴表示

### FR-06: API v1

- /api/v1/municipalities
- APIキー認証
- レートリミット

---

## 6. Non-Functional Requirements

### NFR-01: パフォーマンス

- Lighthouse 90以上
- ISR導入
- DBインデックス最適化

### NFR-02: セキュリティ

- HTTPセキュリティヘッダ
- XSS対策
- SQLインジェクション防止
- Rate Limit実装

### NFR-03: 可用性

- ビルド失敗時の検証バリア
- verify:ci 導入
- 不変条件チェック

### NFR-04: 保守性

- Doc単位分割管理
- 監査ログ永続化
- 設計変更履歴保存

---

## 7. Data Requirements

- 自治体データ（1,737件）
- LinkStatus enum（PDF_ONLY含む）
- AuditLog
- LinkCheckRun
- RecoveryCandidate

---

## 8. Constraints

- Node LTS v22固定
- 大量 git add 禁止
- 差分最小単位適用
- PDF直リンクは pdfUrl に格納
- PDF_ONLY時は url=null

---

## 9. Acceptance Criteria

- 全1,737自治体表示確認
- verify:ci PASS
- API正常応答
- 監査ダッシュボード稼働
- SEOファイル正常生成

---

## 10. Future Expansion

- 自動リンク監査AI
- 改葬許可書自動取得補助
- 他ポータル連携API
- 広告連携モデル
